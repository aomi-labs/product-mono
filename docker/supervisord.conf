[unix_http_server]
file=/tmp/supervisor.sock

[supervisord]
logfile=/tmp/supervisord.log
logfile_maxbytes=50MB
logfile_backups=10
loglevel=info
pidfile=/tmp/supervisord.pid
nodaemon=true
user=forge-mcp

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=unix:///tmp/supervisor.sock

# Network-specific MCP servers (one per network)
[program:mcp-testnet]
command=/home/forge-mcp/bin/mcp-server testnet http://anvil:8545
directory=/home/forge-mcp
autostart=true
autorestart=true
stderr_logfile=/var/log/mcp-testnet.err.log
stdout_logfile=/var/log/mcp-testnet.out.log
environment=FORGE_ENV=production,MCP_SERVER_HOST=0.0.0.0,MCP_SERVER_PORT=5000

[program:mcp-mainnet]
command=/home/forge-mcp/bin/mcp-server mainnet %(ENV_ETH_RPC_URL)s
directory=/home/forge-mcp
autostart=true
autorestart=true
stderr_logfile=/var/log/mcp-mainnet.err.log
stdout_logfile=/var/log/mcp-mainnet.out.log
environment=FORGE_ENV=production,MCP_SERVER_HOST=0.0.0.0,MCP_SERVER_PORT=5001

[program:mcp-polygon]
command=/home/forge-mcp/bin/mcp-server polygon %(ENV_POLYGON_RPC_URL)s
directory=/home/forge-mcp
autostart=true
autorestart=true
stderr_logfile=/var/log/mcp-polygon.err.log
stdout_logfile=/var/log/mcp-polygon.out.log
environment=FORGE_ENV=production,MCP_SERVER_HOST=0.0.0.0,MCP_SERVER_PORT=5002

[program:mcp-base]
command=/home/forge-mcp/bin/mcp-server base %(ENV_BASE_RPC_URL)s
directory=/home/forge-mcp
autostart=true
autorestart=true
stderr_logfile=/var/log/mcp-base.err.log
stdout_logfile=/var/log/mcp-base.out.log
environment=FORGE_ENV=production,MCP_SERVER_HOST=0.0.0.0,MCP_SERVER_PORT=5003

[program:mcp-arbitrum]
command=/home/forge-mcp/bin/mcp-server arbitrum %(ENV_ARBITRUM_RPC_URL)s
directory=/home/forge-mcp
autostart=true
autorestart=true
stderr_logfile=/var/log/mcp-arbitrum.err.log
stdout_logfile=/var/log/mcp-arbitrum.out.log
environment=FORGE_ENV=production,MCP_SERVER_HOST=0.0.0.0,MCP_SERVER_PORT=5004

[program:mcp-linea]
command=/home/forge-mcp/bin/mcp-server linea %(ENV_LINEA_RPC_URL)s
directory=/home/forge-mcp
autostart=true
autorestart=true
stderr_logfile=/var/log/mcp-linea.err.log
stdout_logfile=/var/log/mcp-linea.out.log
environment=FORGE_ENV=production,MCP_SERVER_HOST=0.0.0.0,MCP_SERVER_PORT=5005

# Session-aware backend
[program:backend]
command=/home/forge-mcp/bin/backend
directory=/home/forge-mcp
autostart=true
autorestart=true
stderr_logfile=/var/log/backend.err.log
stdout_logfile=/var/log/backend.out.log
environment=FORGE_ENV=production,BACKEND_HOST=0.0.0.0,BACKEND_PORT=8080

# Frontend
[program:frontend]
command=npm run preview -- --port 3000 --host 0.0.0.0
directory=/home/forge-mcp/frontend
autostart=true
autorestart=true
stderr_logfile=/var/log/frontend.err.log
stdout_logfile=/var/log/frontend.out.log
environment=NODE_ENV=production